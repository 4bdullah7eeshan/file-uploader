<body>
    <%- include('../header') %>
    <%- include('../main/folders') %>
    <%- include('../footer') %>
    <%- include('../modals/newFolder') %>
    <%- include('../modals/editFolder') %>
</body>
<script>
    function editFolder(id, name) {
        document.getElementById('editFolderModal').style.display = 'flex';
        document.getElementById('editFolderId').value = id;
        document.getElementById('editFolderName').value = name;
    }

    function closeEditModal() {
        document.getElementById('editFolderModal').style.display = 'none';
    }

    document.getElementById('editFolderForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const folderId = document.getElementById('editFolderId').value;
        const folderName = document.getElementById('editFolderName').value;

        try {
            const response = await fetch(`/folders/${folderId}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name: folderName })
            });

            if (response.ok) {
                closeEditModal();
                alert("Folder updated successfully!");
                location.reload();
            } else {
                const errorData = await response.json();
                alert("Error updating folder: " + errorData.error);
            }
        } catch (error) {
            alert("Error updating folder: " + error.message);
        }
    });
    async function deleteFolder(folderId) {
    if (!confirm("Are you sure you want to delete this folder?")) return;

    try {
        const response = await fetch(`/folders/${folderId}`, { method: 'DELETE' });

        if (response.ok) {
            alert("Folder deleted successfully!");
            location.reload();
        } else {
            const errorData = await response.json();
            alert("Error deleting folder: " + errorData.error);
        }
    } catch (error) {
        alert("Error deleting folder: " + error.message);
    }
}

function downloadFile(fileId) {
        window.location.href = `/files/${fileId}/download`;
    }

    // Delete File
    async function deleteFile(fileId) {
        if (!confirm("Are you sure you want to delete this file?")) return;

        try {
            const response = await fetch(`/files/${fileId}`, { method: 'DELETE' });

            if (response.ok) {
                alert("File deleted successfully!");
                location.reload();
            } else {
                const errorData = await response.json();
                alert("Error deleting file: " + errorData.error);
            }
        } catch (error) {
            alert("Error deleting file: " + error.message);
        }
    }


</script>